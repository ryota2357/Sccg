# メモ

## HTML エスケープ

ビルド時に Warning が出るので、出たところを次のように修正する

| 文字 | エスケープ |
| :--: | :--------: |
| `&`  |  `&amp;`   |
| `<`  |   `&lt;`   |
| `>`  |   `&gt;`   |

## vim/neovim の help から Source の Group を作成する時の加工用コマンド

- `tr -s '~'` で複数個の`~`を 1 つに圧縮できる
    - `~`には`\n`とか、`\t`とか
    - `tr -s '\n'` で空行を削除になる
- `sed -e 's/ *$//' -e 's/^  */\t/'` で行末の空白を削除 + 行頭の空白をタブに置換
    - sed で` +` ができないので`  *` にしてる
- `sed 's/^\t\*.*\*$//'` で `(タブ)*~~~*` を削除
    - help のタグ行を削除できる
- `gsed -z 's/\n\t/ /g'` でタブ始まりの行を join
    - 複数行の説明を 1 行にする時とか

## vim 正規表現

- Vim で最短マッチは`\{-}`でできる。

## tsv を C#の XML コメントに変換する時のコマンド

- `-F '\t'` で区切り文字をタブに指定
- `-v 'OFS=\n'` で出力の区切り文字を改行に指定

```
awk -F '\t' -v 'OFS=\n' '{
  sub("^","\n/// <summary>\n/// ",$2);
  sub("$","\n/// </summary>",$2);
  sub("$",",",$1);
  print $2,$1 }'
```

## vscode の doc から Source の Group を作成する時の加工用コマンド

```vim
" `- `から始まらない行を削除
:%s/^\(- \)\@!.*//

" ソートと空行除去
:sort u

" 変なのが混じってないか確認(いくつかただのリスト(- hogeが混じってる))
" 多分 先頭にくる。あったら削除する

" tsvに
:%s/- `\(.\{-}\)`: \(.*\)/\1\t\1\t\1 : \2

" 0gg<C-v>GgU で行頭大文字に
```

第一列を大文字区切りに変換 (ChatGPTに作ってもらったのでちゃんと理解はしてない)

```sh
awk -F'\t' 'BEGIN {OFS = FS}
{
    split($1, a, ".")
    $1 = ""
    for(i=1; i<=length(a); i++) {
        $1 = $1 toupper(substr(a[i],1,1)) substr(a[i],2)
    }
    $2 = "new(\"" $2 "\")"
    print $0
}' a.txt > b.txt```
```

 ↓ で XML コメントに変換

```
awk '{
  printf "/// <summary>\n/// %s\n/// </summary>\npublic static readonly Unit %s = %s;\n", $3, $1, $2
}' b.txt > c.txt
```

## TextMate の doc から Source の Group を作成する時の加工用コマンド

- Vim マクロで「a.b.c — 説明」に加工
- `:%s/^\(.\{-}\) — /\1\t\1 ― `を vim で実行
- `:%s/\.\(.\)\(.*\)\t/\u\1\2\t`を vim で複数回実行して、`foo.bar.baz`を`fooBarBaz`に変換
- vim で全ての行の 1 文字目を大文字に変換
- ↑ にある awk (tsv を C#の XML コメントに変換する時のコマンド) を使う
- enum の変数名に`-`が含まれるのが幾つかいるので、手作業で`_`に変換